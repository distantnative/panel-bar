var PanelbarIframe=function(){var e=this;this.active=!1,this.link=null,this.href=null,this.wrapper=panelbar.wrapper.querySelector(".panelbar-iframe__iframe"),this.iframe=this.wrapper.children[1],this.loading=this.wrapper.children[0],this.buttons=panelbar.panelbar.querySelector(".panelbar-iframe__btns"),this.returnBtn=this.buttons.children[0],this.refreshBtn=this.buttons.children[1],this.elements=panelbar.wrapper.querySelectorAll(".panelbar__bar > div"),this.position=null,this.supported=!0,this.init=function(n){e.support();var t=panelbar.panelbar.querySelectorAll(n.join()),r;for(r=0;r<t.length;r++)t[r].addEventListener("click",function(n){e.supported&&(n.preventDefault(),e.activate(this))})},this.support=function(){var n=document.createElement("iframe");n.style.display="none",n.id="PanelBarJStestFrame",n.src=siteURL+"/panel/",document.body.appendChild(n),n.addEventListener("load",function(){document.body.removeChild(n)}),setTimeout(function(){var n=document.getElementById("PanelBarJStestFrame");null===n?e.supported=!0:e.supported=!1},2500)},this.activate=function(n){e.link=n,e.href=e.link.href,e.position=panelbar.position,e.active=!0,e.load(),e.clearPosition(),e.clearPanelbar(),e.buildOverlay()},this.deactivate=function(){e.restorePanelbar(),e.removeOverlay(),e.restorePosition(),e.unload(),e.active=!1},this.refresh=function(){location.reload()},this.load=function(){e.iframe.src=e.href},this.unload=function(){e.iframe.src=""},this.buildOverlay=function(){e.buttons.style.display="inline-block",e.wrapper.style.display="block",document.body.style.overflow="hidden",addClass(panelbar.wrapper,"panelbar--iframe"),e.loading.innerHTML="Loadingâ€¦",setTimeout(function(){e.loading.innerHTML="Seems like something is blocking access to the panel inside an iframe."},3e3),e.returnBtn.addEventListener("click",e.deactivate),e.refreshBtn.addEventListener("click",e.refresh)},this.removeOverlay=function(){e.buttons.style.display="none",e.wrapper.style.display="none",document.body.style.overflow="auto",removeClass(panelbar.wrapper,"panelbar--iframe"),e.loading.innerHTML="",e.returnBtn.removeEventListener("click",e.deactivate),e.refreshBtn.removeEventListener("click",e.refresh)},this.clearPanelbar=function(){e._elements("none"),panelbar.posBtn.style.display="none",panelbar.visBtn.addEventListener("click",e.redirectClose)},this.restorePanelbar=function(){e._elements("inline-block"),panelbar.posBtn.style.display="",panelbar.visBtn.removeEventListener("click",e.redirectClose)},this._elements=function(n){var t;for(t=0;t<e.elements.length;t++)e.elements[t].style.display=n},this.redirectClose=function(){location.href=e.iframe.src,panelbar.show()},this.clearPosition=function(){panelbar.top()},this.restorePosition=function(){"bottom"===e.position&&panelbar.bottom()}};if("querySelector"in document&&"addEventListener"in window){var elements=[".panelbar--add a",".panelbar--edit a",".panelbar--user a",".panelbar-fileviewer__item",".panelbar-fileviewer__more",".panelbar-filelist__item",".panelbar-filelist__more"],panelbarIframe=new PanelbarIframe;panelbarIframe.init(elements)}