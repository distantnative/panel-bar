var PanelBarIframe=function(e){var n=this;this.active=!1,this.link=null,this.href=null,this.wrapper=PanelBar.wrapper.querySelector(".panelbar-iframe__iframe"),this.iframe=this.wrapper.children[1],this.loading=this.wrapper.children[0],this.buttons=PanelBar.bar.querySelector(".panelbar-iframe__btns"),this.returnBtn=this.buttons.children[0],this.refreshBtn=this.buttons.children[1],this.elements=PanelBar.wrapper.querySelectorAll(".panelbar__bar > div"),this.position=null,this.supported=!0,this.init=function(e){n.support();var t=PanelBar.bar.querySelectorAll(e.join()),r;for(r=0;r<t.length;r++)t[r].addEventListener("click",function(e){n.supported&&(e.preventDefault(),n.activate(this))})},this.support=function(){var e=document.createElement("iframe");e.style.display="none",e.id="PanelBarJStestFrame",e.src=siteURL+"/panel/",document.body.appendChild(e),e.addEventListener("load",function(){document.body.removeChild(e)}),setTimeout(function(){var e=document.getElementById("PanelBarJStestFrame");null===e?n.supported=!0:n.supported=!1},2500)},this.activate=function(e){n.link=e,n.href=n.link.href,n.position=PanelBar.position,n.active=!0,n.load(),n.clearPosition(),n.clearPanelbar(),n.buildOverlay()},this.deactivate=function(){n.restorePanelbar(),n.removeOverlay(),n.restorePosition(),n.unload(),n.active=!1},this.refresh=function(){location.reload()},this.load=function(){n.iframe.src=n.href},this.unload=function(){n.iframe.src=""},this.buildOverlay=function(){n.buttons.style.display="inline-block",n.wrapper.style.display="block",document.body.style.overflow="hidden",addClass(PanelBar.wrapper,"panelbar--iframe"),n.loading.innerHTML="Loadingâ€¦",setTimeout(function(){n.loading.innerHTML="Seems like something is blocking access to the panel inside an iframe."},3e3),n.returnBtn.addEventListener("click",n.deactivate),n.refreshBtn.addEventListener("click",n.refresh)},this.removeOverlay=function(){n.buttons.style.display="none",n.wrapper.style.display="none",document.body.style.overflow="auto",removeClass(PanelBar.wrapper,"panelbar--iframe"),n.loading.innerHTML="",n.returnBtn.removeEventListener("click",n.deactivate),n.refreshBtn.removeEventListener("click",n.refresh)},this.clearPanelbar=function(){n._elements("none"),PanelBar.posBtn.style.display="none",PanelBar.visBtn.addEventListener("click",n.redirectClose)},this.restorePanelbar=function(){n._elements("inline-block"),PanelBar.posBtn.style.display="",PanelBar.visBtn.removeEventListener("click",n.redirectClose)},this._elements=function(e){var t;for(t=0;t<n.elements.length;t++)n.elements[t].style.display=e},this.redirectClose=function(){location.href=n.iframe.src,PanelBar.show()},this.clearPosition=function(){PanelBar.top()},this.restorePosition=function(){"bottom"===n.position&&PanelBar.bottom()},this.init(e)};if("querySelector"in document&&"addEventListener"in window)var elements=[".panelbar--panel a",".panelbar--add a",".panelbar--edit a",".panelbar--user a",".panelbar-fileviewer__item",".panelbar-fileviewer__more",".panelbar-filelist__item",".panelbar-filelist__more"],pbIframe=new PanelBarIframe(elements);