var PanelbarIframe=function(){var e=this;this.link=null,this.href=null,this.wrapper=document.querySelector(".panelbar-return__iframe"),this.iframe=this.wrapper.children[0],this.returnBtn=document.querySelector(".panelbar-return__btn"),this.panelbar=document.getElementById("panelbar"),this.elements=document.querySelectorAll(".panelbar__bar > div"),this.controls=document.getElementById("panelbar_controls"),this.position=null,this.form=null,this.submitted=!1,this.activate=function(t){e.link=t,e.href=e.link.href,e.position=hasClass(e.panelbar,"panelbar--top")?"top":"bottom",e.clearPanelbar(),e.buildOverlay(),e.clearPosition(),e.load(),setTimeout(e.bindSubmit,500)},this.deactivate=function(){e.submitted?location.reload():(e.restorePanelbar(),e.removeOverlay(),e.restorePosition(),e.unbindSubmit())},this.load=function(t){e.iframe.src=e.href},this.bindSubmit=function(){e.clearSubmit();var t=e.iframe.contentDocument||e.iframe.contentWindow.document;e.form=t.querySelector(".form"),e.form.addEventListener("submit",e.setSubmit)},this.unbindSubmit=function(){e.form.removeEventListener("submit",e.setSubmit)},this.setSubmit=function(){e.submitted=!0},this.clearSubmit=function(){e.submitted=!1},this.buildOverlay=function(){e.returnBtn.style.display="inline-block",e.wrapper.style.display="block",document.body.style.overflow="hidden",e.returnBtn.addEventListener("click",e.deactivate)},this.removeOverlay=function(){e.returnBtn.style.display="none",e.wrapper.style.display="none",document.body.style.overflow="auto",e.returnBtn.removeEventListener("click",e.deactivate)},this.clearPanelbar=function(){e._elements("none")},this.restorePanelbar=function(){e._elements("inline-block")},this._elements=function(t){var n;for(n=0;n<e.elements.length;n++)e.elements[n].style.display=t;e.controls.style.display=t},this.clearPosition=function(){removeClass(e.panelbar,"panelbar--bottom"),addClass(e.panelbar,"panelbar--top")},this.restorePosition=function(){removeClass(e.panelbar,"panelbar--top"),addClass(e.panelbar,"panelbar--"+e.position)}};if("querySelector"in document&&"addEventListener"in window){var iframelinks=document.querySelectorAll(".panelbar--add a, .panelbar--edit a, .panelbar--toggle a, .panelbar-fileviewer__item, .panelbar-fileviewer__more"),panelbarIframe=new PanelbarIframe,i;for(i=0;i<iframelinks.length;i++)iframelinks[i].addEventListener("click",function(e){e.preventDefault(),panelbarIframe.activate(this)})}